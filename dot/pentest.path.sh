#!/usr/bin/env bash
set -uo pipefail

# =============================================================================
# NAME        : pentest.path.sh
# DESCRIPTION :
# AUTHOR      : Adam Compton
# DATE CREATED: 2024-12-08 19:57:22
# =============================================================================
# EDIT HISTORY:
# DATE                 | EDITED BY    | DESCRIPTION OF CHANGE
# ---------------------|--------------|----------------------------------------
# 2024-12-08 19:57:22  | Adam Compton | Initial creation.
# =============================================================================

# Guard to prevent multiple sourcing
if [[ -z "${PENTEST_PATH_SH_LOADED:-}" ]]; then
    declare -g PENTEST_PATH_SH_LOADED=true

    # ###########################################
    # PENTEST PATHS
    # ###########################################

    # PENTEST CONFIG FILES
    export PENTEST_ENV_FILE="${BASH_DIR}/pentest.env"
    export PENTEST_ALIAS_FILE="${BASH_DIR}/pentest.alias"
    export PENTEST_KEYS_FILE="${BASH_DIR}/pentest.keys"
    export PENTEST_LOG_FILE="${BASH_DIR}/pentest.log"
    export PENTEST_MENU_TIMESTAMP_FILE="${BASH_DIR}/pentest_menu_timestamps"

    # Ensure the timestamp file exists
    if [[ ! -f "${PENTEST_MENU_TIMESTAMP_FILE}" ]]; then
        touch "${PENTEST_MENU_TIMESTAMP_FILE}"
    fi

    # DATA_DIR
    export DATA_DIR="${HOME}/DATA"
    export TOOLS_DIR="${DATA_DIR}/TOOLS"
    export PENTEST_SCRIPTS_DIR="${DATA_DIR}/TOOLS/SCRIPTS"
    export LOGS_DIR="${DATA_DIR}/LOGS"
    export BACKUP_DIR="${DATA_DIR}/BACKUP"

    # LOOT_DIR
    export LOOT_DIR="${DATA_DIR}/LOOT"
    export CREDS_DIR="${DATA_DIR}/LOOT/CREDENTIALS"

    # OUTPUT_DIR
    export OUTPUT_DIR="${DATA_DIR}/OUTPUT"
    export PORTSCAN_DIR="${OUTPUT_DIR}/PORTSCAN"
    export SHARES_DIR="${OUTPUT_DIR}/SHARES"

    # ###########################################
    # PENTEST API KEYS
    # ###########################################

    if [[ -f "${PENTEST_KEYS_FILE}" ]]; then
        source "${PENTEST_KEYS_FILE}"
    else
        echo "File not found: ${PENTEST_KEYS_FILE}. Skipping sourcing."
    fi

    # ###########################################
    # PENTEST ENV
    # ###########################################

    if [[ -f "${PENTEST_ENV_FILE}" ]]; then
        source "${PENTEST_ENV_FILE}"
    else
        echo "File not found: ${PENTEST_ENV_FILE}. Skipping sourcing."
    fi

    # ###########################################
    # PENTEST ALIASES
    # ###########################################

    if [[ -f "${PENTEST_ALIASES_FILE}" ]]; then
        source "${PENTEST_ALIASES_FILE}"
    else
        echo "File not found: ${PENTEST_ALIASES_FILE}. Skipping sourcing."
    fi
fi
